control1 = c(15,12,14,22,21,28,29,30,29,31),
control2 = c(10,5,10,12,16,20,22,21,23,21),
control3 = c(-7,-11,-7,-3,-4,-9,-7,-3,-7,-11),
control4 = c(-15,-13,-14,-16,-15,-12,-13,-13,-14,-14))
#controls are stored as differences from treated unit, translating into levels:
data3$control1 <- data3$control1 + data3$treated
data3$control2 <- data3$control2 + data3$treated
data3$control3 <- data3$control3 + data3$treated
data3$control4 <- data3$control4 + data3$treated
#defining treatment period:
treatperiod <- 6
data<-list(treated = as.matrix(data3$treated),
donors = as.matrix(data3[,-c(1,2)]),
treatment=treatperiod)
result<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=3,
set_f=NA))
#Weights selected, for controls 1 through 4 respectively:
print(round(result$weights,2))
library(Synth)
library(data.table) #for convenience
data(basque)
basque<-basque[regionno!=1,]
basque[,regionname:= gsub(" (.*)","",regionname)]
basque <- cbind(basque[regionno==17,gdpcap],t(reshape(basque[regionno!=17,.(regionno,year,gdpcap)], idvar='regionno', timevar='year',direction='wide')[,-"regionno",with=FALSE]))
data <- list(treated = as.matrix(basque[,1]),
donors = as.matrix(basque[,-1]),
treatment = 16)
result <- masc(data=data, tune_pars_list=list(m=1:10,
min_preperiods=8,
set_f=NA))
#Treatment effects of terrorism on GDP per capita
#in thousands of 1986 US dollars, over 1970-1975:
#(first 6 years of treatment)
print(result$pred.error[1:6,])
library(Synth)
library(data.table) #for convenience
data(basque)
basque<-as.data.table(basque)
basque <- basque[regionno!=1,]
basque[,regionname:= gsub(" (.*)","",regionname)]
basque <- cbind(basque[regionno==17,gdpcap],t(reshape(basque[regionno!=17,.(regionno,year,gdpcap)], idvar='regionno', timevar='year',direction='wide')[,-"regionno",with=FALSE]))
data <- list(treated = as.matrix(basque[,1]),
donors = as.matrix(basque[,-1]),
treatment = 16)
result <- masc(data=data, tune_pars_list=list(m=1:10,
min_preperiods=8,
set_f=NA))
#Treatment effects of terrorism on GDP per capita
#in thousands of 1986 US dollars, over 1970-1975:
#(first 6 years of treatment)
print(result$pred.error[1:6,])
library(masc)
remove.packages("masc", lib="~/R/win-library/3.6")
devtools::install_github("maxkllgg/masc")
?amsc
?masc
library(masc)
?masc
?masc
detach("package:masc", unload = TRUE)
remove.packages("masc", lib="~/R/win-library/3.6")
devtools::install_github("maxkllgg/masc")
library(amsc)
library(masc)
?masc
remove.packages("masc", lib="~/R/win-library/3.6")
devtools::install_github("maxkllgg/masc")
library(masc)
?masc
?masc''
?masc'
?masc
''
?masc
help(masc)
library(masc)
?masc
data3 <- data.frame(t = 1:10, treated = 1:10,
control1 = c(15,12,14,22,21,28,29,30,29,31),
control2 = c(10,5,10,12,16,20,22,21,23,21),
control3 = c(-7,-11,-7,-3,-4,-9,-7,-3,-7,-11),
control4 = c(-15,-13,-14,-16,-15,-12,-13,-13,-14,-14))
#controls are above stored as differences from treated unit. Translating into levels:
data3$control1 <- data3$control1 + data3$treated
data3$control2 <- data3$control2 + data3$treated
data3$control3 <- data3$control3 + data3$treated
data3$control4 <- data3$control4 + data3$treated
#defining treatment period:
treatperiod <- 6
data<-list(treated = as.matrix(data3$treated),
donors = as.matrix(data3[,-c(1,2)]),
treatment=treatperiod)
result<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=3,
set_f=NA))
print(round(result$weights,2))
library(masc)
1+1
help(requireNameSpace)
?requireNameSpace
?requireNamespace
requireNamespace("data.table")
requireNamespace("Synth")
library(masc)
1+1
library(masc)
library(masc)
devtools::load_all(".")
.libPaths()
library(LowRankQP)
install.packages("LowRankQP")
library(LowRankQP)
help(LowRankQP)
library(masc)
?masc
data3 <- data.frame(t = 1:10, treated = 1:10,
control1 = c(15,12,14,22,21,28,29,30,29,31),
control2 = c(10,5,10,12,16,20,22,21,23,21),
control3 = c(-7,-11,-7,-3,-4,-9,-7,-3,-7,-11),
control4 = c(-15,-13,-14,-16,-15,-12,-13,-13,-14,-14))
#controls are above stored as differences from treated unit. Translating into levels:
data3$control1 <- data3$control1 + data3$treated
data3$control2 <- data3$control2 + data3$treated
data3$control3 <- data3$control3 + data3$treated
data3$control4 <- data3$control4 + data3$treated
#defining treatment period:
treatperiod <- 6
data<-list(treated = as.matrix(data3$treated),
donors = as.matrix(data3[,-c(1,2)]),
treatment=treatperiod)
result<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=3,
set_f=NA))
library(masc)
?masc
data3 <- data.frame(t = 1:10, treated = 1:10,
control1 = c(15,12,14,22,21,28,29,30,29,31),
control2 = c(10,5,10,12,16,20,22,21,23,21),
control3 = c(-7,-11,-7,-3,-4,-9,-7,-3,-7,-11),
control4 = c(-15,-13,-14,-16,-15,-12,-13,-13,-14,-14))
#controls are above stored as differences from treated unit. Translating into levels:
data3$control1 <- data3$control1 + data3$treated
data3$control2 <- data3$control2 + data3$treated
data3$control3 <- data3$control3 + data3$treated
data3$control4 <- data3$control4 + data3$treated
#defining treatment period:
treatperiod <- 6
data<-list(treated = as.matrix(data3$treated),
donors = as.matrix(data3[,-c(1,2)]),
treatment=treatperiod)
result<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=3,
set_f=NA))
data3 <- data.frame(t = 1:10, treated = 1:10,
control1 = c(15,12,14,22,21,28,29,30,29,31),
control2 = c(10,5,10,12,16,20,22,21,23,21),
control3 = c(-7,-11,-7,-3,-4,-9,-7,-3,-7,-11),
control4 = c(-15,-13,-14,-16,-15,-12,-13,-13,-14,-14))
#controls are above stored as differences from treated unit. Translating into levels:
data3$control1 <- data3$control1 + data3$treated
data3$control2 <- data3$control2 + data3$treated
data3$control3 <- data3$control3 + data3$treated
data3$control4 <- data3$control4 + data3$treated
#defining treatment period:
treatperiod <- 6
data<-list(treated = as.matrix(data3$treated),
donors = as.matrix(data3[,-c(1,2)]),
treatment=treatperiod)
result<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=3,
set_f=NA))
recover()
recover()
recover()
nogurobi
library(masc)
data3 <- data.frame(t = 1:10, treated = 1:10,
control1 = c(15,12,14,22,21,28,29,30,29,31),
control2 = c(10,5,10,12,16,20,22,21,23,21),
control3 = c(-7,-11,-7,-3,-4,-9,-7,-3,-7,-11),
control4 = c(-15,-13,-14,-16,-15,-12,-13,-13,-14,-14))
#controls are above stored as differences from treated unit. Translating into levels:
data3$control1 <- data3$control1 + data3$treated
data3$control2 <- data3$control2 + data3$treated
data3$control3 <- data3$control3 + data3$treated
data3$control4 <- data3$control4 + data3$treated
#defining treatment period:
treatperiod <- 6
data<-list(treated = as.matrix(data3$treated),
donors = as.matrix(data3[,-c(1,2)]),
treatment=treatperiod)
result<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=3,
set_f=NA))
result<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=3,
set_f=NA), nogurobi=FALSE)
library(masc)
data3 <- data.frame(t = 1:10, treated = 1:10,
control1 = c(15,12,14,22,21,28,29,30,29,31),
control2 = c(10,5,10,12,16,20,22,21,23,21),
control3 = c(-7,-11,-7,-3,-4,-9,-7,-3,-7,-11),
control4 = c(-15,-13,-14,-16,-15,-12,-13,-13,-14,-14))
#controls are above stored as differences from treated unit. Translating into levels:
data3$control1 <- data3$control1 + data3$treated
data3$control2 <- data3$control2 + data3$treated
data3$control3 <- data3$control3 + data3$treated
data3$control4 <- data3$control4 + data3$treated
#defining treatment period:
treatperiod <- 6
data<-list(treated = as.matrix(data3$treated),
donors = as.matrix(data3[,-c(1,2)]),
treatment=treatperiod)
result<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=3,
set_f=NA))
result
result<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=3,
set_f=NA), nogurobi=TRUE)
help(LowRankQP)
tparams$alpha
tparams$beta
tparams$xi
tparams$zeta
library(masc)
?masc
data3 <- data.frame(t = 1:10, treated = 1:10,
control1 = c(15,12,14,22,21,28,29,30,29,31),
control2 = c(10,5,10,12,16,20,22,21,23,21),
control3 = c(-7,-11,-7,-3,-4,-9,-7,-3,-7,-11),
control4 = c(-15,-13,-14,-16,-15,-12,-13,-13,-14,-14))
#controls are above stored as differences from treated unit. Translating into levels:
data3$control1 <- data3$control1 + data3$treated
data3$control2 <- data3$control2 + data3$treated
data3$control3 <- data3$control3 + data3$treated
data3$control4 <- data3$control4 + data3$treated
#defining treatment period:
treatperiod <- 6
data<-list(treated = as.matrix(data3$treated),
donors = as.matrix(data3[,-c(1,2)]),
treatment=treatperiod)
result<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=3,
set_f=NA))
result$weights
result2<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=3,
set_f=NA),nogurobi=TRUE)
result$weights
result2$weights
help("LowRankQP")
library(masc)
?amsc
?masc
result2<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=3,
set_f=NA), nogurobi= TRUE)
result$weights
result2$weights
result2$phi
result$phi
?LowRankQP
sum(result2$weights)
library(masc)
result2<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=3,
set_f=NA), nogurobi= TRUE)
result$weights
result2$weights
rbenchmark::benchmark(result2<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=3,
set_f=NA), nogurobi= TRUE))
help(benchmark)
rbenchmark::benchmark(masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=3,
set_f=NA), nogurobi= TRUE),masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=3,
set_f=NA), nogurobi= TRUE))
rbenchmark::benchmark(masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=3,
set_f=NA), nogurobi= TRUE),masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=3,
set_f=NA), nogurobi= FALSE))
?masc
library(Synth)
library(data.table)
data(basque)
basque<-as.data.table(basque)
basque <- basque[regionno!=1,]
basque[,regionname:= gsub(" (.*)","",regionname)]
basque <- cbind(basque[regionno==17,gdpcap],
t(reshape(basque[regionno!=17,.(regionno,year,gdpcap)],
idvar='regionno', timevar='year',direction='wide')[,-"regionno",with=FALSE]))
data <- list(treated = as.matrix(basque[,1]),
donors = as.matrix(basque[,-1]),
treatment = 16)
result <- masc(data=data, tune_pars_list=list(m=1:10,
min_preperiods=8,
set_f=NA))
result2 <- masc(data=data, tune_pars_list=list(m=1:10,
min_preperiods=8,
set_f=NA), nogurobi = TRUE)
result$weights
result2$weights
cbind(round(result$weights,3),round(result2$weights,3))
result2$phi
result$phi
print(result$pred.error[1:6,])
print(result2$pred.error[1:6,])
result2$pred.error
result$pred.error
The default implementation of this package uses gurobi, which offers free academic licenses.
For more information, see the following link:
masc: Matching and Synthetic Controls Estimator.
========
### Installation
Install using `devtools::install_github("maxkllgg/masc")`.
### Help
See `help(masc)` for details and examples using this package.
### Recommended packages
The default implementation of this package uses gurobi, which offers free academic licenses.
For more information, see the following link:
https://www.gurobi.com/products/optimization-modeling-language-resources-support/r/
?masc
devtools::uses_testthat()
devtools::use_testthat()
devtools::has_tests()
help(synth)
library(Synth)
library(data.table)
data(basque)
basque<-as.data.table(basque)
basque <- basque[regionno!=1,]
basque[,regionname:= gsub(" (.*)","",regionname)]
#Grabbing region names:
names<- c(unique(basque[regionno==17,regionname]),unique(basque[regionno!=17,regionname]))
names
basque <- cbind(basque[regionno==17,gdpcap],
t(reshape(basque[regionno!=17,.(regionno,year,gdpcap)],
idvar='regionno', timevar='year',direction='wide')[,-"regionno",with=FALSE]))
data <- list(treated = as.matrix(basque[,1]),
donors = as.matrix(basque[,-1]),
treatment = 16)
result <- masc(data=data, tune_pars_list=list(m=1:10,
min_preperiods=8,
set_f=NA))
result$weights
names(result$weights)<-names[-1]
result$weights
names(result$weights)<-names[-1]
names(result$pred.error)<-names[-1]
result <- masc(data=data, tune_pars_list=list(m=1:10,
min_preperiods=8,
set_f=NA))
names(result$weights)<-names[-1]
round(result$weights,3)
print(round(result$weights,3))
print(result$pred.error[1:6,])
library(masc)
library(masc)
?masc
library(Synth)
library(data.table)
data(basque)
basque<-as.data.table(basque)
basque <- basque[regionno!=1,]
basque[,regionname:= gsub(" (.*)","",regionname)]
#Grabbing region names:
names<- c(unique(basque[regionno==17,regionname]),unique(basque[regionno!=17,regionname]))
basque <- cbind(basque[regionno==17,gdpcap],
t(reshape(basque[regionno!=17,.(regionno,year,gdpcap)],
idvar='regionno', timevar='year',direction='wide')[,-"regionno",with=FALSE]))
data <- list(treated = as.matrix(basque[,1]),
donors = as.matrix(basque[,-1]),
treatment = 16)
result <- masc(data=data, tune_pars_list=list(m=1:10,
min_preperiods=8,
set_f=NA))
names(result$weights)<-names[-1]
#weights on control units:
print(round(result$weights,3))
result <- masc(data=data, tune_pars_list=list(m=1:10,
min_preperiods=8,
set_f=NA),nogurobi=TRUE)
names(result$weights)<-names[-1]
#weights on control units:
print(round(result$weights,3))
library(masc)
?solve_masc
library(masc)
data3 <- data.frame(t = 1:10, treated = 1:10,
control1 = c(15,12,14,22,21,28,29,30,29,31),
control2 = c(10,5,10,12,16,20,22,21,23,21),
control3 = c(-7,-11,-7,-3,-4,-9,-7,-3,-7,-11),
control4 = c(-15,-13,-14,-16,-15,-12,-13,-13,-14,-14))
#controls are above stored as differences from treated unit. Translating into levels:
data3$control1 <- data3$control1 + data3$treated
data3$control2 <- data3$control2 + data3$treated
data3$control3 <- data3$control3 + data3$treated
data3$control4 <- data3$control4 + data3$treated
#defining treatment period:
treatperiod <- 6
data<-list(treated = as.matrix(data3$treated),
donors = as.matrix(data3[,-c(1,2)]),
treatment=treatperiod)
result<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=3,
set_f=NA))
round(result$weights)
result$weights
result<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=NA,
set_f=4:5))
result$weights
result$cv.error
is_na(3:5)
is.na(3:5)
result<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=NA,
set_f=3:4))
result$weights
result<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=3,
set_f=NA))
result$weights
library(masc)
data3 <- data.frame(t = 1:10, treated = 1:10,
control1 = c(15,12,14,22,21,28,29,30,29,31),
control2 = c(10,5,10,12,16,20,22,21,23,21),
control3 = c(-7,-11,-7,-3,-4,-9,-7,-3,-7,-11),
control4 = c(-15,-13,-14,-16,-15,-12,-13,-13,-14,-14))
#controls are above stored as differences from treated unit. Translating into levels:
data3$control1 <- data3$control1 + data3$treated
data3$control2 <- data3$control2 + data3$treated
data3$control3 <- data3$control3 + data3$treated
data3$control4 <- data3$control4 + data3$treated
#defining treatment period:
treatperiod <- 6
data<-list(treated = as.matrix(data3$treated),
donors = as.matrix(data3[,-c(1,2)]),
treatment=treatperiod)
result<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=3,
set_f=NA))
result$weights
result<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=NA,
set_f=3:4))
result$weights
library(masc)
?masc
data3 <- data.frame(t = 1:10, treated = 1:10,
control1 = c(15,12,14,22,21,28,29,30,29,31),
control2 = c(10,5,10,12,16,20,22,21,23,21),
control3 = c(-7,-11,-7,-3,-4,-9,-7,-3,-7,-11),
control4 = c(-15,-13,-14,-16,-15,-12,-13,-13,-14,-14))
#controls are above stored as differences from treated unit. Translating into levels:
data3$control1 <- data3$control1 + data3$treated
data3$control2 <- data3$control2 + data3$treated
data3$control3 <- data3$control3 + data3$treated
data3$control4 <- data3$control4 + data3$treated
#defining treatment period:
treatperiod <- 6
data<-list(treated = as.matrix(data3$treated),
donors = as.matrix(data3[,-c(1,2)]),
treatment=treatperiod)
result<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=3,
set_f=NA))
result$weights
result<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=NA,
set_f=3:4))
result$weights
result<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=NA,
set_f=3:5))
result$weights
result<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=NA,
set_f=2:5))
result$weights
result<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=4,
set_f=NA))
result$weights
result<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=3,
set_f=NA))
result$weights
result<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=2,
set_f=NA))
result$weights
result<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=4,
set_f=NA))
result$weights
result<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=3,
set_f=NA))
result$weights
result<-masc(data=data, tune_pars_list=list(m=1:3,
min_preperiods=NA,
set_f=list(3:5)))
result$weights
library(masc)
library(masc)
?masc
library(masc)
